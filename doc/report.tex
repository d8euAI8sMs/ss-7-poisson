\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}

\begin{document}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Внутри плоского конденсатора расположена клетка Фарадея, характерный размер клетки меньше характерного размера обкладок конденсатора. Найти распределение электрического поля, построить эквипотенциальные и силовые линии.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Физическая модель}

        Описанную систему будем рассматривать как двумерную. Будем считать, что в одном из направлений (ось $z$) система вытянута так, что вблизи рассматриваемого нами центра системы ($z = 0$) краевыми эффектами в этом направлении можно пренебречь. Распределение потенциала будем искать в плоскости $z = 0$.

        Формализуем знания о системе.
        %
        \begin{enumerate}[noitemsep]
            \item Рассматривается прямоугольная область $a \times b$, помещенная в центр области $ X \times Y$, $X, Y >> a, b$.
            \item Границы области $X \times Y$ сделаны из металла и заземлены.
            \item Правая и левая границы области $a \times b$~--- обкладки плоского конденсатора, каждая из которых имеет полный заряд $q = q_0$ соответствующего знака.
            \item В центре области $a \times b$ расположена клетка Фарадея, сделанная из металла. Полный заряд клетки равен нулю.
            \item Остальное пространство, в т.ч. пространство внутри клетки, заполнено диэлектриком с диэлектрической проницаемостью $\varepsilon = \varepsilon_0$.
        \end{enumerate}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Математическая модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Уравнение Пуассона}

            Уравнение Пуассона имеет вид:
            %
            \begin{equation}\label{eq:poisson_eq}
                \Delta\varphi(\vb{r})
                    = - \frac{\rho(\vb{r})} {\varepsilon \varepsilon_0} ,
            \end{equation}
            %
            где $\rho(\vb{r})$~--- плотность заряда, $\varepsilon$~--- диэлектрическая проницаемость, $\varepsilon_0$~--- универсальная диэлектрическая постоянная.

            На внешней поверхности металла потенциал одинаков и определяется по теореме Гаусса:
            %
            \begin{equation}
                \oint\limits_{\partial\Omega} \vb{E} \dd{\vb{S}}
                    = \frac{1}{\varepsilon_0} \int\limits_\Omega \rho \dd{\Omega}
                    = \frac{q_\Omega}{\varepsilon_0} ,
            \end{equation}
            %
            где $\Omega$~--- область пространства (в т.ч. многосвязная), занимаемая телом, $\partial\Omega$~--- внешняя граница этой области.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Выбор единиц измерения}

            Произведем замену переменных по правилу:
            %
            \begin{equation}
                \rho \mapsto \varepsilon_0 \rho.
            \end{equation}
            %
            Уравнение Пуассона (\autoref{eq:poisson_eq}) при этом примет вид:
            %
            \begin{equation}\label{eq:poisson_eq_dimless}
                \Delta\varphi(\vb{r})
                    = - \frac{\rho(\vb{r})} {\varepsilon} ,
            \end{equation}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Численная модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Дискретная модель}

            Для решения уравнения \autoref{eq:poisson_eq_dimless} перейдем к дискретной модели. Разделим интервал $\qty[0, X]$ на $N$ отрезков $\Delta_x$, а интервал $\qty[0, Y]$~--- на $M$ отрезков $\Delta_y$. Таким образом, получим прямоугольную сетку пространственный узлов $\qty(x_i, y_j)$, $i = 0, 1, \dots, N$, $j = 0, 1, \dots, M$. Величины $\Delta_x$ и $\Delta_y$ определяются размерами минимальной области, которую необходимо описать.

            Значение потенциала будем вычислять в дискретных точках: $\varphi_{i,j} = \varphi(x_i, y_j)$. Пространственные производные аппроксимируем следующим образом:
            %
            \begin{equation}\begin{aligned}
                \eval{\pdv[2]{\varphi}{x}}_{i,j}
                    &\approx \delta^2_x \varphi_{i,j}
                    = \frac{\varphi_{i+1,j} + \varphi_{i-1,j} - 2 \varphi_{i,j}}{\Delta^2_x} \\
                \eval{\pdv[2]{\varphi}{y}}_{i,j}
                    &\approx \delta^2_y \varphi_{i,j}
                    = \frac{\varphi_{i,j+1} + \varphi_{i,j-1} - 2 \varphi_{i,j}}{\Delta^2_y}
            \end{aligned}\end{equation}

            В уравнении \autoref{eq:poisson_eq_dimless} заменим производные их конечно-разностными эквивалентами, остальные непрерывные величины заменим из значениями, вычисленными в узлах сетки. Получим:
            %
            \begin{equation}\label{eq:poisson_eq_discrete_int}
                \delta^2_x \varphi_{i,j} + \delta^2_y \varphi_{i,j}
                    = \frac{\rho_{i,j}}{\varepsilon}
            \end{equation}

            Для решения \autoref{eq:poisson_eq_discrete_int} можно применить метод сеточной релаксации.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Метод сеточной релаксации}

            Опишем метод сеточной релаксации применительно к данной задаче в простейшей его постановке, а именно в постановке Якоби.

            Для этого выразим из \autoref{eq:poisson_eq_discrete_int} значение потенциала в \enquote{текущем} узле $\varphi_{i,j}$:
            %
            \begin{equation}
                \varphi_{i,j} = \qty{2 \qty(\frac{1}{\Delta^2_x} + \frac{1}{\Delta^2_y})}^{-1}
                    \qty(
                        \frac{\varphi_{i-1,j} + \varphi_{i+1,j}}{\Delta^2_x} +
                        \frac{\varphi_{i,j-1} + \varphi_{i,j+1}}{\Delta^2_y} -
                        \frac{\rho_{i,j}}{\varepsilon}
                    )
            \end{equation}
            %
            Если рассматривать левую часть как значение $\varphi_{i,j}$ на текущем шаге, а правую часть рассчитывать, используя значения потенциала с предыдущего шага, получим итерационную схему сеточной релаксации Якоби.

            Если упорядочить обход узлов сетки, например рассчитывать потенциал, двигаясь по узлам сетки слева-направо ($i \mapsto i+1$) сверху-вниз ($j \mapsto j+1$), и для расчета очередного значения потенциала использовать уже найденные значения потенциала в соседних узлах, то получим метод Гаусса-Зейделя, несколько улучшающий сходимость итерационной схемы.

            Таким образом, решение \autoref{eq:poisson_eq_discrete_int} может быть получено итерационным путем из некоторого начального приближения $\varphi_{i,j} = \varphi^{(0)}_{i,j}$. Критерием остановки итераций может служить значение невязки итерационной схемы на текущей итерации.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Анализ результатов}

        В ходе работы была написана демонстрационная программа (\autoref{fig:mainwindow}) на языке  \enquote{C++}, позволяющая исследовать вид электростатического поля в зависимости от конфигурации системы.
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{mainwindow}
            \caption[]{Главное окно программы}
            \label{fig:mainwindow}
        \end{figure}
        %
        Программа строит эквипотенциальные и силовые линии поля по рассчитанным значениям потенциала на каждой итерации.

        Клетка Фарадея моделировалась следующим образом (\autoref{fig:faraday_cage_scheme}). Будем рассматривать две противоположных друг другу стенки клетки \enquote{толщиной} в один узел сетки. Стенки заполнялись материалами в шахматном согласованном порядке (металл--диэлектрик--металл--диэлектрик и т.д. напротив \enquote{металлического} узла левой стенки~--- \enquote{диэлектрический} узел правой стенки). При расчетах значение потенциала, полученное в некоторой точке стенки клетки, присваивалось соответствующему узлу на противоположной стенке, и наоборот.
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=0.5\textwidth]{faraday_cage_scheme}
            \caption[]{Схема моделирования клетки Фарадея}
            \label{fig:faraday_cage_scheme}
        \end{figure}

        Рассмотрим некоторые результаты моделирования.

        Уберем клетку Фарадея и рассмотрим классический плоский конденсатор с равными по модулю зарядами на обкладках (\autoref{fig:pot_1}, \autoref{fig:field_1}). Из теоретических соображений понятно, что электрическое поле должно быть направлено от одной обкладки конденсатора к другой. Эквипотенциальные линии должны окружать каждый из конденсаторов. Результаты моделирования изображают ожидаемую картину. Силовые линии поля входят в металлические поверхности перпендикулярно.
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{pot_1}
            \caption[]{Эквипотенциальные линии плоского конденсатора}
            \label{fig:pot_1}
        \end{figure}
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{field_1}
            \caption[]{Силовые линии плоского конденсатора}
            \label{fig:field_1}
        \end{figure}

        Поменяем у одной из обкладок конденсатора заряд на противоположный (\autoref{fig:pot_2}, \autoref{fig:field_2}). Получим систему из двух одинаково заряженных тел. Тела должны отталкиваться друг от друга, эквипотенциальные линии должны так или иначе окружать всю систему. Описанное наблюдается на результатах моделирования. Силовые линии поля уже не замыкаются на одинаково заряженных телах, а входят в окружающую металлическую оболочку.
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{pot_2}
            \caption[]{Эквипотенциальные линии системы двух одинаково заряженных тел}
            \label{fig:pot_2}
        \end{figure}
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{field_2}
            \caption[]{Силовые линии системы двух одинаково заряженных тел}
            \label{fig:field_2}
        \end{figure}

        Поместим клетку Фарадея между обкладками конденсатора (\autoref{fig:pot_3}, \autoref{fig:field_3}). В идеальном случае клетка должна полностью экранировать внешнее. По результатам моделирования поля внутри клетки практически не наблюдается. Силовые линии поля, однако, проходят и внутри клетки. Но этим линиям соответствует очень слабое поле, на порядки меньше внешнего. Это можно заметить, если уменьшить шаг прорисовывания эквипотенциальных линий.
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{pot_3}
            \caption[]{Эквипотенциальные линии конденсатора с клеткой Фарадея между обкладками}
            \label{fig:pot_3}
        \end{figure}
        %
        \begin{figure}![h]
            \centering
            \includegraphics[width=1\textwidth]{field_3}
            \caption[]{Силовые линии конденсатора с клеткой Фарадея между обкладками}
            \label{fig:field_3}
        \end{figure}

        Теперь поместим конденсатор целиком в клетку Фарадея (\autoref{fig:pot_4}, \autoref{fig:field_4}). В этом случае не должно наблюдаться уже поля вне клетки. Данный эффект виден на результатах моделирования. Cиловые и эквипотенциальные линии находятся в пределах клетки.
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{pot_4}
            \caption[]{Эквипотенциальные линии конденсатора, помещенного в клетку Фарадея}
            \label{fig:pot_4}
        \end{figure}
        %
        \begin{figure}[!h]
            \centering
            \includegraphics[width=1\textwidth]{field_4}
            \caption[]{Силовые линии конденсатора, помещенного в клетку Фарадея}
            \label{fig:field_4}
        \end{figure}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Выводы}

        В ходе работы была написана демонстрационная программа, позволяющая исследовать вид электростатического поля в зависимости от конфигурации рассматриваемой системы.

        Результаты моделирования классических случаев совпадают с ожидаемыми.

\end{document}
